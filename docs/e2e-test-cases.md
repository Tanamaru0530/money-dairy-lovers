# Money Dairy Lovers - E2Eテストケース

## 概要
このドキュメントは、Money Dairy Loversアプリケーションの主要な機能をカバーするE2Eテストケースを定義します。各テストケースは、実際のユーザーの操作フローを模倣し、アプリケーションが期待通りに動作することを確認します。

## 前提条件
- アプリケーションが起動していること（フロントエンド: http://localhost:3000、バックエンド: http://localhost:8000）
- データベースがクリーンな状態であること
- テスト用のメールアドレスが使用可能であること

## テストケース

### 1. 認証フロー

#### TC001: 新規ユーザー登録
**目的**: 新規ユーザーが正常に登録できることを確認する

**手順**:
1. ブラウザで http://localhost:3000 にアクセス
2. ログイン画面が表示されることを確認
3. 「新規登録して愛を記録する」ボタンをクリック
4. 登録フォームに以下を入力:
   - 表示名: `テスト太郎`
   - メールアドレス: `test1@example.com`
   - パスワード: `TestPass123!`
   - パスワード確認: `TestPass123!`
5. 「💕 登録して愛を始める」ボタンをクリック
6. ダッシュボードにリダイレクトされることを確認
7. 画面上部のナビゲーションに「テスト太郎」が表示されることを確認

**期待結果**:
- 登録が成功し、自動的にログインされる
- ダッシュボードが表示される
- ウェルカムメッセージが表示される

#### TC002: ログイン・ログアウト
**目的**: 既存ユーザーがログイン・ログアウトできることを確認する

**手順**:
1. TC001で作成したユーザーでログアウト状態から開始
2. ログイン画面でメールアドレスとパスワードを入力
3. 「ログイン」ボタンをクリック
4. ダッシュボードが表示されることを確認
5. ナビゲーションの「ログアウト」ボタンをクリック
6. ログイン画面にリダイレクトされることを確認

**期待結果**:
- ログインが成功する
- ログアウト後、ログイン画面に戻る

### 2. カテゴリ管理

#### TC003: デフォルトカテゴリの確認
**目的**: デフォルトカテゴリが正しく表示されることを確認する

**手順**:
1. ログイン状態でナビゲーションの「📁 カテゴリ」をクリック
2. デフォルトカテゴリが表示されることを確認:
   - 🍽️ 食費
   - 🚗 交通費
   - 🏠 住居費
   - 🎬 娯楽費
   - 👕 日用品
   - 🏥 医療費
   - 💕 デート代（Love カテゴリ）
   - 🎁 プレゼント（Love カテゴリ）
   - 📚 その他

**期待結果**:
- すべてのデフォルトカテゴリが表示される
- Loveカテゴリには特別なスタイルが適用される

#### TC004: カスタムカテゴリの作成
**目的**: ユーザーがカスタムカテゴリを作成できることを確認する

**手順**:
1. カテゴリ一覧画面で「新しいカテゴリを追加」ボタンをクリック
2. フォームに以下を入力:
   - カテゴリ名: `ペット費用`
   - アイコン: 🐕
   - 色: #8B4513（茶色）
3. 「作成」ボタンをクリック
4. カテゴリ一覧に新しいカテゴリが追加されることを確認

**期待結果**:
- カスタムカテゴリが正常に作成される
- 一覧に新しいカテゴリが表示される

### 3. 取引管理

#### TC005: 支出の登録（個人）
**目的**: 個人の支出を登録できることを確認する

**手順**:
1. ダッシュボードまたはナビゲーションから「💰 取引」をクリック
2. 「➕ 新しい取引を追加」ボタンをクリック
3. Step 1: 金額入力
   - 金額: `3000` を入力
   - 「次へ」をクリック
4. Step 2: カテゴリ選択
   - 取引タイプ: 「💸 支出」を選択
   - カテゴリ: 「🍽️ 食費」を選択
   - 「次へ」をクリック
5. Step 3: 詳細入力
   - 日付: 今日の日付（デフォルト）
   - 説明: `ランチ代`
   - 支払い方法: 「現金」
   - 共有タイプ: 「👤 個人」
   - 「登録する」をクリック

**期待結果**:
- 取引が正常に登録される
- ダッシュボードの最近の取引に表示される
- 月次サマリーの支出額が更新される

#### TC006: Love取引の登録（共有）
**目的**: Love評価付きの共有取引を登録できることを確認する

**手順**:
1. 「➕ 新しい取引を追加」ボタンをクリック
2. Step 1: 金額入力
   - 金額: `10000` を入力
3. Step 2: カテゴリ選択
   - 取引タイプ: 「💸 支出」
   - カテゴリ: 「💕 デート代」を選択
4. Step 3: 詳細入力
   - 説明: `記念日ディナー`
   - 共有タイプ: 「👫 共有」を選択
   - 分割方法: 「均等割り」
   - Love評価: ⭐⭐⭐⭐⭐（5つ星）を選択
   - 「登録する」をクリック

**期待結果**:
- Love取引が登録される
- Love統計に反映される
- 共有支出として記録される

### 4. パートナーシップ機能

#### TC007: パートナー招待
**目的**: パートナーを招待できることを確認する

**手順**:
1. ナビゲーションの「💑 パートナー」をクリック
2. 「パートナーを招待する」セクションで招待方法を選択
3. 招待コードが生成されることを確認
4. 招待コードをコピー

**期待結果**:
- 6桁の招待コードが生成される
- QRコードが表示される

#### TC008: パートナー連携
**目的**: 招待コードでパートナー連携できることを確認する

**手順**:
1. 別のブラウザ/プライベートウィンドウで新規ユーザーとして登録
   - 表示名: `テスト花子`
   - メールアドレス: `test2@example.com`
2. パートナーシップ画面で「招待コードを入力」を選択
3. TC007でコピーした招待コードを入力
4. 「連携する」をクリック
5. 両方のアカウントでパートナー情報が表示されることを確認

**期待結果**:
- パートナー連携が成功する
- 両方のアカウントでパートナー情報が表示される

### 5. 予算管理

#### TC009: 月次予算の設定
**目的**: 月次予算を設定できることを確認する

**手順**:
1. ナビゲーションの「💰 予算」をクリック
2. 「➕ 新しい予算を作成」ボタンをクリック
3. 基本情報を入力:
   - 予算名: `今月の食費予算`
   - 予算金額: `50000`
   - 期間: 「月次」
   - カテゴリ: 「🍽️ 食費」
4. 詳細設定:
   - アラート閾値: `80`%
   - 「💕 Love予算として設定」: チェックなし
   - 「👫 パートナーと共有」: チェック
5. 「作成する」をクリック

**期待結果**:
- 予算が作成される
- 予算一覧に表示される
- 進捗バーが0%で表示される

#### TC010: 予算アラートの確認
**目的**: 予算の閾値を超えた時にアラートが表示されることを確認する

**手順**:
1. TC009で作成した食費予算があることを前提
2. 食費カテゴリで合計45,000円以上の取引を登録
3. 予算画面を確認

**期待結果**:
- 進捗バーが90%以上（赤色）で表示される
- アラートアイコンが表示される

### 6. レポート機能

#### TC011: 月次レポートの確認
**目的**: 月次レポートが正しく表示されることを確認する

**手順**:
1. ナビゲーションの「📊 レポート」をクリック
2. 「月次レポート」タブが選択されていることを確認
3. 以下の情報が表示されることを確認:
   - 収支サマリー（収入、支出、残高）
   - カテゴリ別支出（円グラフ）
   - 日別支出推移（折れ線グラフ）

**期待結果**:
- グラフが正しく表示される
- 登録した取引が反映されている

#### TC012: Love統計の確認
**目的**: Love統計が正しく表示されることを確認する

**手順**:
1. レポート画面で「Love統計」タブをクリック
2. 以下の情報が表示されることを確認:
   - Love支出合計
   - Love取引件数
   - 平均Love評価
   - Love支出推移グラフ

**期待結果**:
- TC006で登録したLove取引が反映される
- Love評価が正しく表示される

### 7. Love機能

#### TC013: 記念日の登録
**目的**: 記念日を登録できることを確認する

**手順**:
1. ナビゲーションの「💕 Love」をクリック
2. 「イベント」ビューを選択
3. 「イベントを追加」ボタンをクリック
4. 以下を入力:
   - イベント名: `付き合った記念日`
   - イベントタイプ: 「記念日」
   - 日付: 任意の日付
   - 繰り返し: ON
   - リマインダー: 7日前
5. 「登録」をクリック

**期待結果**:
- 記念日が登録される
- イベント一覧に表示される
- カレンダーに記念日が表示される

#### TC014: Loveカレンダーの確認
**目的**: Loveカレンダーが正しく機能することを確認する

**手順**:
1. Love画面で「カレンダー」ビューを選択
2. 月の切り替えボタンで前後の月に移動
3. Love取引がある日付にハートマークが表示されることを確認
4. 記念日がカレンダー上に表示されることを確認

**期待結果**:
- カレンダーが正しく表示される
- Love取引と記念日が視覚的に確認できる

### 8. モバイル対応

#### TC015: モバイルナビゲーション
**目的**: モバイルサイズでナビゲーションが正しく動作することを確認する

**手順**:
1. ブラウザの開発者ツールでモバイルビュー（375px幅）に切り替え
2. ハンバーガーメニューが表示されることを確認
3. ハンバーガーメニューをタップ
4. ナビゲーションメニューが表示されることを確認
5. メニュー項目をタップして画面遷移を確認
6. オーバーレイをタップしてメニューが閉じることを確認

**期待結果**:
- モバイルメニューが正しく動作する
- 画面遷移が正常に行われる

### 9. エラーハンドリング

#### TC016: バリデーションエラーの確認
**目的**: フォームバリデーションが正しく機能することを確認する

**手順**:
1. 新しい取引を追加画面を開く
2. 金額に「0」を入力して次へ
3. エラーメッセージが表示されることを確認
4. 金額に「-100」を入力
5. エラーメッセージが更新されることを確認

**期待結果**:
- 適切なエラーメッセージが表示される
- エラー状態のスタイルが適用される

#### TC017: ネットワークエラーの確認
**目的**: ネットワークエラー時の動作を確認する

**手順**:
1. 開発者ツールでネットワークをオフラインに設定
2. 新しい取引を登録しようとする
3. エラートーストが表示されることを確認
4. ネットワークをオンラインに戻す

**期待結果**:
- 「ネットワークエラーが発生しました」というメッセージが表示される
- アプリケーションがクラッシュしない

## テスト完了基準

- すべてのテストケースが成功すること
- エラーやクラッシュが発生しないこと
- UIが期待通りに表示されること
- データが正しく保存・表示されること

## 注意事項

- テスト実行前は必ずデータベースをクリーンな状態にする
- テスト用のメールアドレスを使用する（本番環境では使用しない）
- 各テストケースは独立して実行可能であること